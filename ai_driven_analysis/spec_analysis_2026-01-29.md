# Spec Analysis ‚Äî 2026-01-29

–í—Å–µ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –∞–Ω–∞–ª–∏–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ Timezone Bot.

---

## üìä –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: 82/100 ‚≠ê‚≠ê‚≠ê‚≠ê

---

## ‚úÖ –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã

| –ê—Å–ø–µ–∫—Ç | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|--------|--------|-------------|
| **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** | 9/10 | –û—Ç–ª–∏—á–Ω–∞—è –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å (Capture ‚Üí Transform ‚Üí Response). UTC-Pivot ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω. |
| **Technology Stack** | 9/10 | –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä: `zoneinfo`/`tzdata` (PEP 615), `aiosqlite`, `aiogram`, `timezonefinder` |
| **Storage Schema** | 8/10 | –ß–∏—Å—Ç–∞—è —Å—Ö–µ–º–∞, –ø—Ä–∞–≤–∏–ª–æ "IANA Only" –∏—Å–∫–ª—é—á–∞–µ—Ç –æ—à–∏–±–∫–∏ offset'–æ–≤ |
| **Capture Logic** | 8/10 | Regex-first –ø–æ–¥—Ö–æ–¥ ‚Äî —Ä–∞–∑—É–º–Ω—ã–π –∫–æ–º–ø—Ä–æ–º–∏—Å—Å –¥–ª—è MVP |
| **Response Format** | 9/10 | –ü—Ä–æ–¥—É–º–∞–Ω–Ω—ã–π: –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞, day markers (`‚Å∫¬π`/`‚Åª¬π`), —Ñ–ª–∞–≥–∏ —Å—Ç—Ä–∞–Ω |
| **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** | 8/10 | ASCII-–¥–∏–∞–≥—Ä–∞–º–º—ã, —Ç–∞–±–ª–∏—Ü—ã, –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ ‚Äî –æ—á–µ–Ω—å —á–∏—Ç–∞–µ–º–æ |
| **Scope Control** | 9/10 | –ß—ë—Ç–∫–∏–π "Out of Scope", –∑–∞–ø—Ä–µ—Ç LLM –≤ —Ä–∞–Ω—Ç–∞–π–º–µ, no hardcode |

---

## ‚ö†Ô∏è –ü—Ä–æ–±–µ–ª—ã –∏ —Ä–∏—Å–∫–∏

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (–Ω—É–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –¥–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –§–∞–π–ª | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|---|----------|------|--------------|
| 1 | **–°—Ö–µ–º–∞ —Å–æ–æ–±—â–µ–Ω–∏–π Telegram –Ω–µ –æ–ø–∏—Å–∞–Ω–∞** | –ù–µ—Ç | –î–æ–±–∞–≤–∏—Ç—å —Å–ø–µ–∫: –∫–∞–∫–∏–µ –ø–æ–ª—è Message –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è, –∫–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å forwards, replies, edited messages |
| 2 | **Rate limiting –æ—Ç–≤–µ—Ç–æ–≤** | `04_bot_logic.md` | Open Question –Ω–µ —Ä–µ—à—ë–Ω. –†–∏—Å–∫ —Å–ø–∞–º–∞ –±–æ—Ç–æ–º –ø—Ä–∏ —á–∞—Å—Ç—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–∞—Ö |
| 3 | **Private vs Group chats** | `04_bot_logic.md` | Open Question –Ω–µ —Ä–µ—à—ë–Ω. –ù—É–∂–Ω–∞ –ª–æ–≥–∏–∫–∞ –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —á–∞—Ç–æ–≤ |
| 4 | **Error handling** | –ù–µ—Ç | –ù–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ (network, geocoding fail, DB lock) |

### üü° –°—Ä–µ–¥–Ω–∏–µ (–º–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å, –Ω–æ –ª—É—á—à–µ —Ä–µ—à–∏—Ç—å)

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---|----------|-------------|
| 5 | **Regex –≤ config.yaml** | –í `02_capture_logic.md` —Å–∫–∞–∑–∞–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ regex –≤ config, –Ω–æ –≤ `configuration.yaml` –∏—Ö –Ω–µ—Ç |
| 6 | **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è** | –í—Å–µ —Ç–µ–∫—Å—Ç—ã –Ω–∞ —Å–º–µ—Å–∏ EN/RU. –ù–µ—Ç –ø–ª–∞–Ω–∞ –¥–ª—è i18n |
| 7 | **Fallback flow** | `04_bot_logic.md` –æ–ø–∏—Å—ã–≤–∞–µ—Ç "—Å–ø—Ä–æ—Å–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω–æ–µ –≤—Ä–µ–º—è", –Ω–æ UX –Ω–µ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω |
| 8 | **Health checks / Logging** | –ù–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ observability |

### üü¢ –ú–∏–Ω–æ—Ä–Ω—ã–µ

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---|----------|-------------|
| 9 | `/tb_remove` permissions | –õ—é–±–æ–π –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å –ª—é–±–æ–≥–æ ‚Äî —Ä–∏—Å–∫ abuse. –û–±—Å—É–¥–∏—Ç—å |
| 10 | Edge case `12:45` | –ü—Ä–∏–Ω—è—Ç —Ä–∏—Å–∫ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π (—Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ —Å—á–µ—Ç–∞) ‚Äî –û–ö –¥–ª—è MVP |

---

## üìà –û—Ü–µ–Ω–∫–∞ –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –í–µ—Å | –ë–∞–ª–ª | –í–∑–≤–µ—à–µ–Ω–Ω—ã–π |
|----------|-----|------|------------|
| **–ü–æ–ª–Ω–æ—Ç–∞** (–≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–ø–∏—Å–∞–Ω—ã) | 25% | 75 | 18.75 |
| **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å** | 25% | 90 | 22.5 |
| **–†–µ–∞–ª–∏–∑—É–µ–º–æ—Å—Ç—å** (–º–æ–∂–Ω–æ –∫–æ–¥–∏—Ç—å –ø–æ —Å–ø–µ–∫—É) | 20% | 80 | 16 |
| **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** (–Ω–µ—Ç –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–π) | 15% | 85 | 12.75 |
| **Maintainability** (–ª–µ–≥–∫–æ –æ–±–Ω–æ–≤–ª—è—Ç—å) | 15% | 80 | 12 |
| **–ò–¢–û–ì–û** | 100% | ‚Äî | **82/100** |

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

**–î–æ –Ω–∞—á–∞–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
1. ‚úçÔ∏è –°–æ–∑–¥–∞—Ç—å `09_message_schema.md` ‚Äî –æ–ø–∏—Å–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å Telegram Message
2. ‚úçÔ∏è –†–µ—à–∏—Ç—å Open Questions –≤ `04_bot_logic.md` (rate limit, private chats)
3. ‚úçÔ∏è –î–æ–±–∞–≤–∏—Ç—å regex –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ `configuration.yaml`

**–í–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
4. –û–ø–∏—Å–∞—Ç—å error handling –∫–∞–∫ —á–∞—Å—Ç—å –ø–µ—Ä–≤–æ–≥–æ PR

---

## –†–µ–∑—é–º–µ

–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Ö–æ—Ä–æ—à–æ –ø—Ä–æ—Ä–∞–±–æ—Ç–∞–Ω–∞ –¥–ª—è MVP. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã. –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã ‚Äî –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ (error handling, rate limiting) –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ (Telegram message schema). –ü–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è 4 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤ ‚Äî –ø–æ–ª–Ω–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∫–æ–¥–∏–Ω–≥—É.
